# 先把kubernets跑起来

## 通过web浏览器快速部署kubernets集群

- 打开网页 [Interactive Tutorial - Creating a Cluster | Kubernetes](https://kubernetes.io/docs/tutorials/kubernetes-basics/create-cluster/cluster-interactive/)

* 在终端中执行`minikube start` 来创建一个单节点的`kubernets`集群
* 使用 `kubectl get nodes` 查看集群中的节点

```shell
$ kubectl get nodes
NAME       STATUS   ROLES                  AGE   VERSION
minikube   Ready    control-plane,master   44s   v1.20.2
```

- 使用`kubectl cluster-info`查看集群信息

```shell
$ kubectl cluster-info
Kubernetes control plane is running at https://10.0.0.16:8443
KubeDNS is running at https://10.0.0.16:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
```

- 通过`kubectl run`部署应用，命名为`kubernetes-bootcamp`，通过`--image`指定`docker`镜像，通过`--port`设置应用对外服务的端口

```shell
$ kubectl run kubernetes-bootcamp \
        --image=docker.io/jocatalin/kubernetes-bootcamp:v1 \
        --port=8080
pod/kubernetes-bootcamp created
```

> Kubernetes有一个重要的术语Pod
>
> 1.Pod是容器的集合，通常会将紧密相关的一组容器放到一个Pod中，同一个Pod中的所有容器共享IP地址和Port空间，也就是说它们在一个network namespace中。
>
> 2.Pod是Kubernetes调度的最小单位，同一Pod中的容器始终被一起调度。

- 通过`kubectl get pods`，查看当前的pod

```shell
root@host3:~# kubectl get pods
NAME                  READY   STATUS    RESTARTS   AGE
kubernetes-bootcamp   1/1     Running   0          10m
```

## 访问应用

默认情况下，所有Pod只能在集群内部访问。对于上面这个例子，要访问应用只能直接访问容器的8080端口。为了能够从外部访问应用，我们需要将容器的8080端口映射到节点的端口。

```shell
root@host3:~# kubectl expose pod/kubernetes-bootcam --type="NodePort" --port 8080
service/kubernetes-bootcamp exposed
```

执行命令`kubectl get services`，可以查看应用被映射到节点的哪个端口

```shell
root@host3:~# kubectl get services
NAME                  TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
kubernetes            ClusterIP   10.96.0.1        <none>        443/TCP          24h
kubernetes-bootcamp   NodePort    10.105.248.184   <none>        8080:30322/TCP   53s
```

